<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clear and Add Test Bookings</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #c82333;
        }
        button.add {
            background: #28a745;
        }
        button.add:hover {
            background: #218838;
        }
        button.sync {
            background: #007bff;
        }
        button.sync:hover {
            background: #0056b3;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .success { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .info { background: #d1ecf1; border-color: #bee5eb; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Clear Database and Add Test Bookings</h1>
        <p>This will clear all existing bookings and add test bookings for August 30th, 2025.</p>
        
        <button onclick="clearAllBookings()">üóëÔ∏è Clear All Bookings</button>
        <button class="add" onclick="addTestBookings()">‚ûï Add Test Bookings</button>
        <button class="sync" onclick="syncToGoogleCalendar()">üîÑ Sync to Google Calendar</button>
        
        <div id="status"></div>
    </div>

    <!-- Firebase & Config -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="config.js"></script>
    
    <script>
        let db = null;
        
        window.addEventListener('load', function() {
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            addStatus('Firebase initialized successfully', 'success');
        });

        function addStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            const timestamp = new Date().toLocaleTimeString();
            statusDiv.innerHTML += `[${timestamp}] ${message}\n`;
            statusDiv.className = type;
            statusDiv.scrollTop = statusDiv.scrollHeight;
        }

        async function clearAllBookings() {
            if (!confirm('Are you sure you want to delete ALL bookings? This cannot be undone!')) {
                return;
            }
            
            addStatus('Starting to clear all bookings...', 'info');
            
            try {
                const snapshot = await db.collection('bookings').get();
                const batch = db.batch();
                
                snapshot.docs.forEach((doc) => {
                    batch.delete(doc.ref);
                });
                
                await batch.commit();
                addStatus(`Successfully deleted ${snapshot.docs.length} bookings`, 'success');
                
            } catch (error) {
                addStatus(`Error clearing bookings: ${error.message}`, 'error');
            }
        }

        async function addTestBookings() {
            addStatus('Adding all test bookings for August 25-30, 2025...', 'info');
            
            const bookings = [
                // August 23, 2025 - Fully blocked out (multiple overlapping bookings)
                { appointmentDate: '2025-08-23', appointmentTime: '07:00', duration: 180, name: 'Test Customer A', phone: '555-0000', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '08:00', duration: 180, name: 'Test Customer B', phone: '555-0001', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '09:00', duration: 180, name: 'Test Customer C', phone: '555-0002', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '10:00', duration: 180, name: 'Test Customer D', phone: '555-0003', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '11:00', duration: 180, name: 'Test Customer E', phone: '555-0004', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '12:00', duration: 180, name: 'Test Customer F', phone: '555-0005', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '13:00', duration: 180, name: 'Test Customer G', phone: '555-0006', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '14:00', duration: 180, name: 'Test Customer H', phone: '555-0007', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-23', appointmentTime: '15:00', duration: 180, name: 'Test Customer I', phone: '555-0008', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                
                // August 25, 2025 - Overlapping bookings to block out times
                { appointmentDate: '2025-08-25', appointmentTime: '07:00', duration: 180, name: 'Test Customer 1', phone: '555-0001', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-25', appointmentTime: '08:00', duration: 180, name: 'Test Customer 1B', phone: '555-0002', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-25', appointmentTime: '10:00', duration: 180, name: 'Test Customer 2', phone: '555-0003', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-25', appointmentTime: '11:00', duration: 180, name: 'Test Customer 2B', phone: '555-0004', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-25', appointmentTime: '13:00', duration: 150, name: 'Test Customer 3', phone: '555-0005', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-25', appointmentTime: '14:00', duration: 150, name: 'Test Customer 3B', phone: '555-0006', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-25', appointmentTime: '15:30', duration: 150, name: 'Test Customer 4', phone: '555-0007', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-25', appointmentTime: '16:30', duration: 150, name: 'Test Customer 4B', phone: '555-0008', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                
                // August 26, 2025 - Overlapping bookings
                { appointmentDate: '2025-08-26', appointmentTime: '07:00', duration: 180, name: 'Test Customer 5', phone: '555-0009', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-26', appointmentTime: '08:00', duration: 180, name: 'Test Customer 5B', phone: '555-0010', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-26', appointmentTime: '15:00', duration: 120, name: 'Test Customer 6', phone: '555-0011', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-26', appointmentTime: '16:00', duration: 120, name: 'Test Customer 6B', phone: '555-0012', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                
                // August 27, 2025 - Overlapping bookings
                { appointmentDate: '2025-08-27', appointmentTime: '07:00', duration: 240, name: 'Test Customer 7', phone: '555-0013', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-27', appointmentTime: '08:00', duration: 240, name: 'Test Customer 7B', phone: '555-0014', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-27', appointmentTime: '11:00', duration: 60, name: 'Test Customer 8', phone: '555-0015', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-27', appointmentTime: '12:00', duration: 60, name: 'Test Customer 8B', phone: '555-0016', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                
                // August 28, 2025 - Overlapping bookings
                { appointmentDate: '2025-08-28', appointmentTime: '07:00', duration: 180, name: 'Test Customer 9', phone: '555-0017', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-28', appointmentTime: '08:00', duration: 180, name: 'Test Customer 9B', phone: '555-0018', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-28', appointmentTime: '09:00', duration: 180, name: 'Test Customer 10', phone: '555-0019', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-28', appointmentTime: '10:00', duration: 180, name: 'Test Customer 10B', phone: '555-0020', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-28', appointmentTime: '12:00', duration: 60, name: 'Test Customer 11', phone: '555-0021', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-28', appointmentTime: '13:00', duration: 60, name: 'Test Customer 11B', phone: '555-0022', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                
                // August 29, 2025 - Overlapping bookings
                { appointmentDate: '2025-08-29', appointmentTime: '10:00', duration: 120, name: 'Test Customer 12', phone: '555-0023', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-29', appointmentTime: '11:00', duration: 120, name: 'Test Customer 12B', phone: '555-0024', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-29', appointmentTime: '14:00', duration: 120, name: 'Test Customer 13', phone: '555-0025', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-29', appointmentTime: '15:00', duration: 120, name: 'Test Customer 13B', phone: '555-0026', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                
                // August 30, 2025 - Overlapping bookings
                { appointmentDate: '2025-08-30', appointmentTime: '07:00', duration: 180, name: 'Test Customer 14', phone: '555-0027', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-30', appointmentTime: '08:00', duration: 180, name: 'Test Customer 14B', phone: '555-0028', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-30', appointmentTime: '10:00', duration: 120, name: 'Test Customer 15', phone: '555-0029', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 },
                { appointmentDate: '2025-08-30', appointmentTime: '11:00', duration: 120, name: 'Test Customer 15B', phone: '555-0030', style: 'Test', totalPrice: 0, depositAmount: 0, remainingBalance: 0 }
            ];

            try {
                for (const booking of bookings) {
                    const bookingId = `test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                    
                    await db.collection('bookings').doc(bookingId).set({
                        ...booking,
                        bookingId: bookingId,
                        createdAt: new Date(),
                        status: 'confirmed'
                    });
                    
                    addStatus(`Added booking: ${booking.appointmentTime} (${booking.duration} minutes)`, 'success');
                }
                
                addStatus('All test bookings added successfully!', 'success');
                
            } catch (error) {
                addStatus(`Error adding bookings: ${error.message}`, 'error');
            }
        }

        async function syncToGoogleCalendar() {
            addStatus('Syncing all bookings to Google Calendar...', 'info');
            
            try {
                const response = await fetch('https://us-central1-connect-2a17c.cloudfunctions.net/syncAllBookingsToGoogleCalendar', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    addStatus(`Google Calendar sync complete: ${result.successful} successful, ${result.errors} errors`, 'success');
                } else {
                    const error = await response.text();
                    addStatus(`Google Calendar sync failed: ${error}`, 'error');
                }
                
            } catch (error) {
                addStatus(`Error syncing to Google Calendar: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html> 